<% @kind = kind rescue '' %>
<% @search ||= Search.new('kind' => @kind) %>
<% content_for :heads do %>
  <%= javascript_include_tag "search" %>
<% end %>
<div id="admins">
  <div class="cleanfix" style="height:2px"></div>
    <span "gary_span">搜索1KG</span>
    <% form_tag '/search', :method => 'get' do %>
      <input type="text" name="q" size="25" class="form-text" value="<%= @search.q %>" onclick="clear_search_box();" id='query-box' onblur="search_box_blur();" />
      <input type="submit" value="搜索" class="form-submit" onclick="clear_search_box();" />
      <p class="small"  style="margin:0px;">
        <%= radio_button_tag :kind, 'all', @search.kind == 'all', :onchange => 'switch_search_to("all");' %> 全部
        <%= radio_button_tag :kind, 'school', @search.kind == 'school', :onchange => 'switch_search_to("school");' %> 学校
        <%= radio_button_tag :kind, 'activity', @search.kind == 'activity', :onchange => 'switch_search_to("activity");' %> 活动
        <%= radio_button_tag :kind, 'share', @search.kind == 'share', :onchange => 'switch_search_to("share");' %> 分享
        <%= radio_button_tag :kind, 'group', @search.kind == 'group', :onchange => 'switch_search_to("group");' %> 小组
        <%= radio_button_tag :kind, 'topic', @search.kind == 'topic', :onchange => 'switch_search_to("topic");' %> 话题
      </p>
      
      <p class="small" style="margin:0px;"><%= link_to_function '高级选项', 'toggle_advanced_search();' %></p>

      <p id="advance_search" style="<%= 'display:none;' unless @search.advanced? %>">
        <%= label_tag '标题' %><%= text_field_tag :title, @search.title %><br />
        <%= label_tag '城市' %><%= text_field_tag :city, @search.city %>
      </p>
      <p id="advance_school" style="<%= 'display:none;' unless @search.advanced? && @search.kind == 'school' %>">
        <%= label_tag '地址' %><%= text_field_tag :address, @search.address %><br />
        <%= label_tag '需求' %><%= text_field_tag :need, @search.need %><br />
        <%= check_box_tag :has_library, 1, @search.has_library %><%= label_tag '是否有图书馆' %><br />
        <%= check_box_tag :has_pc, 1, @search.has_pc %><%= label_tag '是否有电脑' %><br />
      </p>
      <p id="advance_share" style="<%= 'display:none;' unless @search.advanced? && @search.kind == 'share' %>">
        <%= label_tag '学校' %><%= text_field_tag :school_title, @search.school_title %><br />
        <%= label_tag '正文' %><%= text_field_tag :content, @search.content, :id => 'search_content' %>
      </p>
      <p id="advance_activity" style="<%= 'display:none;' unless @search.advanced? && @search.kind == 'activity' %>">
        <%= label_tag '类型' %><%= select_tag :category, options_for_select([''] + Activity.categories, @search.need) %><br />
        <% Search::DATE_RANGE.each do |d| %>
          <%= radio_button_tag :on, d, @search.on == d %> <%= d %>
        <% end %><br />
        <%= check_box_tag :include_over, '1', @search.include_over %>包含已结束活动
        <br />
      </p>
    <% end %>
  <div class="cleanfix" style="height:10px"></div>
</div>

<script type="text/javascript" charset="utf-8">
  function clear_query_box()
  {
    if($("#query-box").val() == "学校名称,地址,城市,需求...")
      $("#query-box").val('');
    return true;
  }
</script>